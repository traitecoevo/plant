---
title: "ci_time_check"
author: "Isaac Towers"
date: "2023-08-09"
output: html_document
---

```{r}
tibble(ci_abs_tol = 1e-03) %>%
  mutate(leaf = map(ci_abs_tol, ~make_leaf(control = Control(ci_abs_tol = .x)))) %>%
  expand_grid(psi_stem = seq(0.5,4,length.out = 1000000)) -> low_acc
  
tibble(ci_abs_tol = 1e-07) %>%
  mutate(leaf = map(ci_abs_tol, ~make_leaf(control = Control(ci_abs_tol = .x)))) %>%
  expand_grid(psi_stem = seq(0.5,4,length.out = 1000000)) -> high_acc

system.time(low_acc %>%
  mutate(outcome = map2_dbl(.x = leaf, .y = psi_stem, ~.x$psi_stem_to_ci(.y)))) -> low_out

system.time(high_acc %>%
  mutate(outcome = map2_dbl(.x = leaf, .y = psi_stem, ~.x$psi_stem_to_ci(.y)))) -> high_out
```

